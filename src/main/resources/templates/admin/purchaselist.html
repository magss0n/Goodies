<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Bootstrap Admin Template">
    <meta name="keywords"
          content="admin, estimates, bootstrap, business, corporate, creative, invoice, html5, responsive, Projects">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>Dreams Pos admin template</title>

    <link rel="shortcut icon" type="image/x-icon" href="/assets-admin/img/favicon.jpg">

    <link rel="stylesheet" href="/assets-admin/css/bootstrap.min.css">

    <link rel="stylesheet" href="/assets-admin/css/bootstrap-datetimepicker.min.css">

    <link rel="stylesheet" href="/assets-admin/css/animate.css">

    <link rel="stylesheet" href="/assets-admin/plugins/select2/css/select2.min.css">

    <link rel="stylesheet" href="/assets-admin/css/dataTables.bootstrap4.min.css">

    <link rel="stylesheet" href="/assets-admin/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="/assets-admin/plugins/fontawesome/css/all.min.css">

    <link rel="stylesheet" href="/assets-admin/css/style.css">
</head>
<body>
<div class="main-wrapper">

    <div th:replace="~{/fragments/adminFrag :: header(${admin.getName().substring(0,1).toUpperCase() + admin.getName().substring(1).toLowerCase()})}"></div>

    <div th:replace="~{/fragments/adminFrag :: sidebar}"></div>

    <div class="page-wrapper">
        <div class="content">
            <div class="page-header">
                <div class="page-title">
                    <h4>PURCHASE LIST</h4>
                    <h6>Manage your purchases</h6>
                </div>
                <div class="page-btn">
                    <button type="button" class="btn btn-added" data-bs-target="#purchaseModal" data-bs-toggle="modal">
                        <img src="/assets-admin/img/icons/plus.svg" alt="img">Add New Purchases
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <div class="table-top">
                        <div class="search-set">
                            <div class="search-path">
                                <a class="btn btn-filter" id="filter_search">
                                    <img src="/assets-admin/img/icons/filter.svg" alt="img">
                                    <span><img src="/assets-admin/img/icons/closes.svg" alt="img"></span>
                                </a>
                            </div>
                            <div class="search-input">
                                <a class="btn btn-searchset"><img src="/assets-admin/img/icons/search-white.svg"
                                                                  alt="img"></a>
                            </div>
                        </div>
                        <div class="wordset">
                            <ul>
                                <li>
                                    <a data-bs-toggle="tooltip" data-bs-placement="top" title="pdf"><img
                                            src="/assets-admin/img/icons/pdf.svg" alt="img"></a>
                                </li>
                                <li>
                                    <a data-bs-toggle="tooltip" data-bs-placement="top" title="excel"><img
                                            src="/assets-admin/img/icons/excel.svg" alt="img"></a>
                                </li>
                                <li>
                                    <a data-bs-toggle="tooltip" data-bs-placement="top" title="print"><img
                                            src="/assets-admin/img/icons/printer.svg" alt="img"></a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="card" id="filter_inputs">
                        <div class="card-body pb-0">
                            <div class="row">
                                <div class="col-lg col-sm-6 col-12">
                                    <div class="form-group">
                                        <input type="text" class="datetimepicker cal-icon" placeholder="Choose Date">
                                    </div>
                                </div>
                                <div class="col-lg col-sm-6 col-12">
                                    <div class="form-group">
                                        <input type="text" placeholder="Enter Reference">
                                    </div>
                                </div>
                                <div class="col-lg col-sm-6 col-12">
                                    <div class="form-group">
                                        <select class="select">
                                            <option>Choose Supplier</option>
                                            <option>Supplier</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg col-sm-6 col-12">
                                    <div class="form-group">
                                        <select class="select">
                                            <option>Choose Status</option>
                                            <option>Inprogress</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg col-sm-6 col-12">
                                    <div class="form-group">
                                        <select class="select">
                                            <option>Choose Payment Status</option>
                                            <option>Payment Status</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-1 col-sm-6 col-12">
                                    <div class="form-group">
                                        <a class="btn btn-filters ms-auto"><img
                                                src="/assets-admin/img/icons/search-whites.svg" alt="img"></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table datanew">
                            <thead>
                            <tr>
                                <th>Ref</th>
                                <th>Supplier Name</th>
                                <th>Product Name</th>
                                <th>Cost Price</th>
                                <th>Qty bought</th>
                                <th>Grand Total</th>
                                <th>Purchase Date</th>
                                <th>Action</th>
                            </tr>
                            </thead>
                            <tbody>
                                <tr th:each="purchase: ${purchases}">
                                    <td th:text="${purchase.getId()}"></td>
                                    <td class="text-bolds" th:text="${purchase.getSupplier().getName().substring(0,1).toUpperCase() + purchase.getSupplier().getName().substring(1).toLowerCase()}">Apex Computers</td>
                                    <td th:text="${purchase.getProduct().getName().substring(0,1).toUpperCase() + purchase.getProduct().getName().substring(1).toLowerCase()}">PT001</td>
                                    <td th:text="${purchase.getProduct().getCostPrice()} + ' XAF'">19 Nov 2022</td>
                                    <td th:text="${purchase.getQty()}"></td>
                                    <td th:text="${purchase.getQty()*purchase.getProduct().getCostPrice() +' XAF'}">550</td>
                                    <td th:text="${purchase.getDateTime().toString().split('T')[0] + ' at ' + purchase.getDateTime().toString().split('T')[1]}">120</td>
                                <td>
                                    <a href="javascript:void(0);" class="me-3"
                                       onclick="document.getElementById('editPurchaseModal').style.display='block'">
                                        <img src="/assets-admin/img/icons/edit.svg" alt="img">
                                    </a>
                                    <a class="me-3 confirm-text" href="javascript:void(0);">
                                        <img src="/assets-admin/img/icons/delete.svg" alt="img">
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>


<!-- Add Purchase Modal -->
<div class="modal fade" id="purchaseModal" tabindex="-1" aria-labelledby="addPurchaseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addProductModalLabel">Add New Purchase</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" >X</button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <form id="addPurchaseForm" method="post" th:action="@{/admin/addpurchase}" th:object="${newPurchase}">
                            <div class="row">
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label for="prodName">Product</label>
                                        <select id="prodName" class="form-control" name="productId">
                                            <option selected value="">--Select Product--</option>
                                            <option th:each="product: ${products}" th:value="${product.getId()}" th:text="${product.getName().split(' ')[0].toUpperCase()}"></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12" >
                                    <div class="form-group">
                                        <label for="purchaseDate">Purchase Date</label>
                                        <input type="datetime-local" class="form-control" th:max="${#temporals.formatISO(localDateTime)}"  id="purchaseDate" required th:field="*{dateTime}" name="purchaseDate">
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label>Quantity</label>
                                        <input type="number" min="1" class="form-control" id="" th:field="*{qty}" required>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <label>Reason <span class="fst-italic">(optional)</span></label>
                                        <textarea class="form-control" th:field="*{reason}"></textarea>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12 d-flex align-items-center gap-3" id="supplier">
                                    <div class="form-group" >
                                        <label for="supp">Supplier</label>
                                        <select class="form-control" id="supp" name="supplierId" required>
                                            <option value="" selected>--Choose Supplier--</option>
                                            <option th:if="${suppliers != null}" th:each="supplier: ${suppliers}" th:value="${supplier.getId()}" th:text="${supplier.getName()}"></option>
                                        </select>
                                    </div>
<!--                                    <button class="btn btn-primary text-white" type="button" id="createSupp">Create Supplier</button>-->
                                    <div class="col-lg-2 ps-0" id="createSupp">
                                        <div class="add-icon">
                                            <a href="javascript:void(0);"><img src="/assets-admin/img/icons/plus1.svg"  alt="img"></a>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-12 col-sm-6 col-12" id="supplierName" hidden>
                                    <div class="form-group d-inline mx-2">
                                        <label>Supplier Name</label>
                                        <input type="text" minlength="1" class="form-control" name="supplierName" required>
                                    </div>
                                    <div class="form-group d-inline mx-2">
                                        <label>Supplier Phone</label>
                                        <input type="number" min="600000000" max="699999999" name="supplierPhone" class="form-control" required>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" onclick="console.log('SOUMETSSS')" onsubmit="console.log('nooooooonn')" class="btn btn-submit" id="save-btn">Save</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- The Edit Modal -->
<div id="editPurchaseModal" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
        <div class="modal-header">
            <h2>Edit Purchase</h2>
            <span class="close"
                  onclick="document.getElementById('editPurchaseModal').style.display='none'">&times;</span>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Supplier Name</label>
                        <div class="row">
                            <div class="col-lg-10 col-sm-10 col-10">
                                <select class="select">
                                    <option>Select</option>
                                    <option selected>Supplier</option>
                                </select>
                            </div>
                            <div class="col-lg-2 col-sm-2 col-2 ps-0">
                                <div class="add-icon">
                                    <a href="javascript:void(0);"><img src="/assets-admin/img/icons/plus1.svg" alt="img"></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Purchase Date </label>
                        <div class="input-groupicon">
                            <input type="text" placeholder="DD-MM-YYYY" class="datetimepicker" value="15-05-2025">
                            <div class="addonset">
                                <img src="/assets-admin/img/icons/calendars.svg" alt="img">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Product Name</label>
                        <select class="select">
                            <option>Choose</option>
                            <option selected>Supplier Name</option>
                        </select>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Reference No.</label>
                        <input type="text" value="PO-0012">
                    </div>
                </div>
                <div class="col-lg-12 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Product Name</label>
                        <div class="input-groupicon">
                            <input type="text" placeholder="Scan/Search Product by code and select...">
                            <div class="addonset">
                                <img src="/assets-admin/img/icons/scanners.svg" alt="img">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>QTY</th>
                            <th>Purchase Price($)</th>
                            <th>Discount($)</th>
                            <th>Tax %</th>
                            <th>Tax Amount($)</th>
                            <th class="text-end">Unit Cost($)</th>
                            <th class="text-end">Total Cost ($)</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td class="productimgname">
                                <a class="product-img">
                                    <img src="/assets-admin/img/product/product7.jpg" alt="product">
                                </a>
                                <a href="javascript:void(0);">Apple Earpods</a>
                            </td>
                            <td><input type="text" value="10.00" style="width: 70px;"></td>
                            <td><input type="text" value="2000.00" style="width: 70px;"></td>
                            <td><input type="text" value="500.00" style="width: 70px;"></td>
                            <td><input type="text" value="0.00" style="width: 70px;"></td>
                            <td><input type="text" value="0.00" style="width: 70px;"></td>
                            <td class="text-end">2000.00</td>
                            <td class="text-end">2000.00</td>
                            <td>
                                <a class="delete-set"><img src="/assets-admin/img/icons/delete.svg" alt="svg"></a>
                            </td>
                        </tr>
                        <tr>
                            <td class="productimgname">
                                <a class="product-img">
                                    <img src="/assets-admin/img/product/product6.jpg" alt="product">
                                </a>
                                <a href="javascript:void(0);">Macbook Pro</a>
                            </td>
                            <td><input type="text" value="15.00" style="width: 70px;"></td>
                            <td><input type="text" value="6000.00" style="width: 70px;"></td>
                            <td><input type="text" value="100.00" style="width: 70px;"></td>
                            <td><input type="text" value="0.00" style="width: 70px;"></td>
                            <td><input type="text" value="0.00" style="width: 70px;"></td>
                            <td class="text-end">1000.00</td>
                            <td class="text-end">1000.00</td>
                            <td>
                                <a class="delete-set"><img src="/assets-admin/img/icons/delete.svg" alt="svg"></a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 float-md-right">
                    <div class="total-order">
                        <ul>
                            <li>
                                <h4>Order Tax</h4>
                                <h5>$ 0.00 (0.00%)</h5>
                            </li>
                            <li>
                                <h4>Discount</h4>
                                <h5>$ 600.00</h5>
                            </li>
                            <li>
                                <h4>Shipping</h4>
                                <h5>$ 0.00</h5>
                            </li>
                            <li class="total">
                                <h4>Grand Total</h4>
                                <h5>$ 21400.00</h5>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Order Tax</label>
                        <input type="text" value="0">
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Discount</label>
                        <input type="text" value="600">
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Shipping</label>
                        <input type="text" value="0">
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 col-12">
                    <div class="form-group">
                        <label>Status</label>
                        <select class="select">
                            <option>Choose Status</option>
                            <option selected>Completed</option>
                            <option>Inprogress</option>
                        </select>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="form-group">
                        <label>Description</label>
                        <textarea class="form-control">Purchase order for Apple Earpods and Macbook Pro</textarea>
                    </div>
                </div>
                <div class="col-lg-12">
                    <a href="javascript:void(0);" class="btn btn-submit me-2"
                       onclick="document.getElementById('editPurchaseModal').style.display='none'">Update</a>
                    <a href="javascript:void(0);" class="btn btn-cancel"
                       onclick="document.getElementById('editPurchaseModal').style.display='none'">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="/assets-admin/js/jquery-3.6.0.min.js"></script>

<script src="/assets-admin/js/feather.min.js"></script>

<script src="/assets-admin/js/jquery.slimscroll.min.js"></script>

<script src="/assets-admin/js/jquery.dataTables.min.js"></script>
<script src="/assets-admin/js/dataTables.bootstrap4.min.js"></script>

<script src="/assets-admin/js/bootstrap.bundle.min.js"></script>

<script src="/assets-admin/js/moment.min.js"></script>
<script src="/assets-admin/js/bootstrap-datetimepicker.min.js"></script>

<script src="/assets-admin/plugins/select2/js/select2.min.js"></script>

<script src="/assets-admin/plugins/sweetalert/sweetalert2.all.min.js"></script>
<script src="/assets-admin/plugins/sweetalert/sweetalerts.min.js"></script>

<script src="/assets-admin/js/script.js"></script>
<script>
    let saveBtn = document.querySelector("#save-btn")
    let createSupplier = document.querySelector("#createSupp")
    let productForm = document.querySelector("form")
    let supplierSelect = document.querySelector("#supp")


    supplierSelect.addEventListener("input", () => {
        document.querySelector("#supplierName").hidden = true
        document.getElementsByName("supplierName")[0].required = false
        document.getElementsByName("supplierPhone")[0].required = false
        document.querySelector("#supp").required = true
    })

    createSupplier.addEventListener("click", () => {
        document.querySelector("#supplierName").hidden = false
        document.querySelector("#createSupp").hidden = true
        document.querySelector("#supp").required = false
    })

    let purchaseDate = document.querySelector("#purchaseDate")
    purchaseDate.addEventListener("input", () => {
        let date = new Date(purchaseDate.value)
        saveBtn.disabled = date > Date.now();
        this.style.borderColor = saveBtn.disabled ? 'red' : 'rgb(10, 77, 184)'
    })

</script>

</body>
</html>