<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Bootstrap Admin Template">
    <meta name="keywords"
          content="admin, estimates, bootstrap, business, corporate, creative, invoice, html5, responsive, Projects">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>Dreams Pos admin template</title>

    <link rel="shortcut icon" type="image/x-icon" href="/assets-admin/img/favicon.jpg">

    <link rel="stylesheet" href="/assets-admin/css/bootstrap.min.css">

    <link rel="stylesheet" href="/assets-admin/css/product.css">

    <link rel="stylesheet" href="/assets-admin/css/animate.css">

    <link rel="stylesheet" href="/assets-admin/plugins/select2/css/select2.min.css">

    <link rel="stylesheet" href="/assets-admin/css/dataTables.bootstrap4.min.css">

    <link rel="stylesheet" href="/assets-admin/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="/assets-admin/plugins/fontawesome/css/all.min.css">

    <link rel="stylesheet" href="/assets-admin/css/style.css">
</head>
<body>

<div class="main-wrapper">

    <div th:replace="~{/fragments/adminFrag :: header(${admin.getName().substring(0,1).toUpperCase() + admin.getName().substring(1).toLowerCase()})}"></div>

    <div th:replace="~{/fragments/adminFrag :: sidebar}"></div>

    <div class="page-wrapper">
        <div class="content">
            <div class="page-header">
                <div class="page-title">
                    <h4>Product List</h4>
                    <h6>Manage your products</h6>
                </div>
                <!-- <div class="page-btn">
                <a href="addproduct.html" class="btn btn-added"><img src="/assets-admin/img/icons/plus.svg" alt="img" class="me-1">Add New Product</a>
                </div> -->

                <!-- Add Product Button -->
                <div class="page-btn">
                    <a th:href="@{/admin/addproduct}" class="btn btn-added" data-bs-toggle="modal" data-bs-target="#addProductModal">
                        <img src="/assets-admin/img/icons/plus.svg" alt="img" class="me-1">Add New Product
                    </a>
                </div>
            </div>


            <div class="card">
                <div class="card-body">
                    <div class="table-top">
                        <div class="search-set">
                            <div class="search-path">
                                <a class="btn btn-filter" id="filter_search">
                                    <img src="/assets-admin/img/icons/filter.svg" alt="img">
                                    <span><img src="/assets-admin/img/icons/closes.svg" alt="img"></span>
                                </a>
                            </div>
                            <div class="search-input">
                                <a class="btn btn-searchset"><img src="/assets-admin/img/icons/search-white.svg" alt="img"></a>
                            </div>
                        </div>
                        <div class="wordset">
                            <ul>
                                <li>
                                    <a data-bs-toggle="tooltip" data-bs-placement="top" title="pdf"><img
                                            src="/assets-admin/img/icons/pdf.svg" alt="img"></a>
                                </li>
                                <li>
                                    <a data-bs-toggle="tooltip" data-bs-placement="top" title="excel"><img
                                            src="/assets-admin/img/icons/excel.svg" alt="img"></a>
                                </li>
                                <li>
                                    <a data-bs-toggle="tooltip" data-bs-placement="top" title="print"><img
                                            src="/assets-admin/img/icons/printer.svg" alt="img"></a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="card mb-0" id="filter_inputs">
                        <div class="card-body pb-0">
                            <div class="row">
                                <div class="col-lg-12 col-sm-12">
                                    <div class="row">
                                        <div class="col-lg col-sm-6 col-12">
                                            <div class="form-group">
                                                <select class="select">
                                                    <option>Choose Product</option>
                                                    <option>Macbook pro</option>
                                                    <option>Orange</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg col-sm-6 col-12">
                                            <div class="form-group">
                                                <select class="select">
                                                    <option>Choose Category</option>
                                                    <option>Computers</option>
                                                    <option>Fruits</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg col-sm-6 col-12">
                                            <div class="form-group">
                                                <select class="select">
                                                    <option>Choose Sub Category</option>
                                                    <option>Computer</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg col-sm-6 col-12">
                                            <div class="form-group">
                                                <select class="select">
                                                    <option>Brand</option>
                                                    <option>N/D</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg col-sm-6 col-12 ">
                                            <div class="form-group">
                                                <select class="select">
                                                    <option>Price</option>
                                                    <option>150.00</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg-1 col-sm-6 col-12">
                                            <div class="form-group">
                                                <a class="btn btn-filters ms-auto"><img
                                                        src="/assets-admin/img/icons/search-whites.svg" alt="img"></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table  datanew">
                            <thead>
                            <tr>
                                <th>Product Name</th>
                                <th>Category</th>
                                <th>Brand</th>
                                <th>Cost Price</th>
                                <th>Sell Price</th>
                                <th>Size</th>
                                <th>Type</th>
                                <th>Qty</th>
                                <th>Creation Time</th>
                                <th>Action</th>
                            </tr>
                            </thead>
                            <tbody>
                            <th:block th:if="products==null">There are no products for now</th:block>
                            <tr th:each="product: ${products}" th:unless="products == null">
                                <td class="d-flex align-items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-seam-fill" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.01-.003.268-.108a.75.75 0 0 1 .558 0l.269.108.01.003zM10.404 2 4.25 4.461 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339L8 5.961 5.596 5l6.154-2.461z"/>
                                    </svg>
                                    <span class="ms-3" th:text="${product.getName().split(' ')[0]}"></span>
                                </td>
                                <td th:text="${product.getCategory().getName().substring(0,1).toUpperCase() + product.getCategory().getName().substring(1).toLowerCase()}">PT001</td>
                                <td th:text="${product.getName().split(' ')[1]}">Computers</td>
                                <td th:text="${product.getCostPrice()} + ' XAF'"> N/D</td>
                                <td th:text="${product.getSellPrice()} + ' XAF'"> N/D</td>
                                <td th:text="${product.getSize()}">1500.00</td>
                                <td th:text="${product.getType().substring(0,1).toUpperCase() + product.getType().substring(1).toLowerCase()}">pc</td>
                                <td th:text="${product.getQuantity()}">100.00</td>
                                <td th:text="${product.getCreationTime().toString().split('T')[0] + ' at ' + product.getCreationTime().toString().split('T')[1]}">120</td>
                                <td>
                                    <a class="me-3" th:href="@{/admin/product-details}">
                                        <img src="/assets-admin/img/icons/eye.svg" alt="img">
                                    </a>
                                    <a class="me-3" href="editproduct.html">
                                        <img src="/assets-admin/img/icons/edit.svg" alt="img">
                                    </a>
                                    <a class="confirm-text" href="javascript:void(0);">
                                        <img src="/assets-admin/img/icons/delete.svg" alt="img">
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>


<!-- Add Product Modal -->
<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" >X</button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body">
                        <form id="addProductForm" method="post" th:action="@{/admin/addproduct}" th:object="${newProduct}" enctype="multipart/form-data">
                            <div class="row">
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label for="prodName">Product Name</label>
                                        <input type="text" class="form-control" name="prodName" id="prodName" th:field="*{name}" required>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label for="category">Category</label>
                                        <select class="form-control" id="category" name="category" th:field="*{category}" required>
                                            <option value="" selected>--Choose Category--</option>
                                            <option th:each="cat: ${categories}" th:text="${cat.name}" th:value="${cat.getId()}"></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12" id="sizeDress" hidden>
                                    <div class="form-group">
                                        <label for="size">Size</label>
                                        <select class="form-control" id="size" th:field="*{size}">
                                            <option value="" selected>--Select size--</option>
                                            <option value="XS">XS</option>
                                            <option value="S">S</option>
                                            <option value="M">M</option>
                                            <option value="L">L</option>
                                            <option value="XL">XL</option>
                                            <option value="XXL">XXL</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-3 col-sm-6 col-12" id="sizeShoe" hidden>
                                    <div class="form-group">
                                        <label for="shoe">Size</label>
                                        <input type="number" class="form-control" min="1" list="sizes" id="shoe" required placeholder="Enter size" name="size">
                                        <datalist class="" id="sizes" >
                                            <option value="36">36</option>
                                            <option value="38">38</option>
                                            <option value="42">42</option>
                                            <option value="44">44</option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label for="type">Type</label>
                                        <select class="form-control" id="type" name="type" required th:field="*{type}">
                                            <option value="" selected>--Choose type--</option>
                                            <option value="men">For Men</option>
                                            <option value="women">Women's wear</option>
                                            <option value="mixed">Mixed</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label>Brand</label>
                                        <input list="brands" class="form-control" placeholder="Enter product brand" name="brand" required>
                                        <datalist id="brands" class="">
                                            <option value="GUCCI">GUCCI</option>
                                            <option value="LOUIS VUITTON">LOUIS VUITTON</option>
                                            <option value="H&M">H&M</option>
                                            <option value="BALENCIAGA">BALENCIAGA</option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label>Cost Price</label>
                                        <input type="number" step="0.01" min="1" class="form-control" id="costPrice" th:field="*{costPrice}" required>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label>Sell Price</label>
                                        <input type="number" step="0.01" min="1" class="form-control" id="sellPrice" th:field="*{sellPrice}" required>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label>Minimum Qty</label>
                                        <input type="number" class="form-control" min="0" th:field="*{minQuantity}" list="minqtties" id="minQty" required>
                                        <datalist id="minqtties">
                                            <option value="10">10</option>
                                            <option value="20">20</option>
                                            <option value="30">30</option>
                                            <option value="40">40</option>
                                            <option value="50">50</option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label>Initial Quantity</label>
                                        <input type="number" class="form-control" min="0" th:field="*{quantity}" id="qty" list="qtties" required>
                                        <datalist id="qtties">
                                            <option value="50">50</option>
                                            <option value="100">100</option>
                                            <option value="150">150</option>
                                            <option value="200">200</option>
                                            <option value="250">250</option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <label>Description</label>
                                        <textarea class="form-control" th:field="*{description}" required></textarea>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>Product image</label>
                                        <div class="image-upload">
                                            <input type="file" id="productImage" accept="image/jpeg, image/png" name="photo" required>
                                            <div class="image-uploads">
                                                <img src="/assets-admin/img/icons/upload.svg" alt="img">
                                                <h4 id="imgName"> Drag and drop a file to upload new image</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-3 col-sm-6 col-12" id="supplier">
                                    <div class="form-group" >
                                        <label for="supp">Supplier</label>
                                        <select class="form-control" id="supp" name="supplierId" required>
                                            <option value="" selected>--Choose Supplier--</option>
                                            <option th:if="${suppliers != null}" th:each="supplier: ${suppliers}" th:value="${supplier.getId()}" th:text="${supplier.getName()}"></option>
                                        </select>
                                    </div>
                                    <button class="btn btn-primary text-white" type="button" id="createSupp">Create Supplier</button>
                                </div>

                                <div class="col-lg-3 col-sm-6 col-12" id="supplierName" hidden>
                                    <div class="form-group">
                                        <label>Supplier Name</label>
                                        <input type="text" minlength="1" class="form-control" name="supplierName" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Supplier Phone</label>
                                        <input type="number" min="600000000" max="699999999" name="supplierPhone" class="form-control" required>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" onclick="console.log('SOUMETSSS')" onsubmit="console.log('nooooooonn')" class="btn btn-submit" id="save-btn">Save</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>


<script src="/assets-admin/js/jquery-3.6.0.min.js"></script>


<script src="/assets-admin/js/feather.min.js"></script>

<script src="/assets-admin/js/jquery.slimscroll.min.js"></script>

<script src="/assets-admin/js/jquery.dataTables.min.js"></script>
<script src="/assets-admin/js/dataTables.bootstrap4.min.js"></script>

<script src="/assets-admin/js/bootstrap.bundle.min.js"></script>

<script src="/assets-admin/plugins/select2/js/select2.min.js"></script>

<script src="/assets-admin/plugins/sweetalert/sweetalert2.all.min.js"></script>
<script src="/assets-admin/plugins/sweetalert/sweetalerts.min.js"></script>

<script src="/assets-admin/js/script.js"></script>
<script>
    let shoeSize = document.querySelector("#sizeShoe")
    let sizeDress = document.querySelector("#sizeDress")
    let categories =document.querySelector("#category")
    let saveBtn = document.querySelector("#save-btn")
    let createSupplier = document.querySelector("#createSupp")
    let productForm = document.querySelector("form")
    let supplierSelect = document.querySelector("#supp")
    let imgInp = document.querySelector("#productImage")
    let costPrice = document.querySelector("#costPrice")
    let sellPrice = document.querySelector("#sellPrice")

    imgInp.addEventListener('input', () => {
        console.log("Image :" + imgInp.value)
        document.querySelector("#imgName").innerHTML = imgInp.value
    })

    supplierSelect.addEventListener("input", () => {
        document.querySelector("#supplierName").hidden = true
        document.getElementsByName("supplierName")[0].required = false
        document.getElementsByName("supplierPhone")[0].required = false
        document.querySelector("#supp").required = true
    })


    createSupplier.addEventListener("click", () => {
        document.querySelector("#supplierName").hidden = false
        document.querySelector("#createSupp").hidden = true
        document.querySelector("#supp").required = false

    })
    console.log(categories)

    function submitForm() {
        if (productForm.checkValidity()){
            productForm.submit()
        }
    }

    categories.addEventListener("change", (ev) => {
        console.log("\nTa mere\n")
        if(ev.target.value === "shoe"){
            shoeSize.hidden = false
            sizeDress.hidden = true
            shoeSize.querySelector("input").required = true
            sizeDress.querySelector("select").required = false
        } else{
            shoeSize.hidden = true
            sizeDress.hidden = false
            shoeSize.querySelector("input").required = false
            sizeDress.querySelector("select").required = true
        }
    })

    let minQty = document.querySelector("#minQty")
    let qty = document.querySelector("#qty")

    let validQty = (min, actual) => {
        console.log({min, actual})
        if (Number(min.value) > Number(actual.value)) {
            min.style.borderColor = "red"
            actual.style.borderColor = "red"
            saveBtn.disabled = true
            console.log(saveBtn)
        } else{
            saveBtn.disabled = false
            min.style.borderColor = "green"
            actual.style.borderColor = "green"
        }
    }

    costPrice.addEventListener("input", () => validQty(costPrice, sellPrice))
    sellPrice.addEventListener("input", () => validQty(costPrice, sellPrice))

    qty.addEventListener("input",() => {
        validQty(minQty, qty)
    });

    minQty.addEventListener("input", () => {
        validQty(minQty, qty)
    });


</script>
</body>
</html>